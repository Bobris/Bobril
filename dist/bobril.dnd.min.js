!function(t){function e(){var t="no-drop";if(0!==X.length){var e=X[0];if(e.beforeDrag)return"";if(null!=e.cursor)return e.cursor;if(e.system)return"";switch(e.operation){case 3:t="move";break;case 1:t="alias";break;case 2:t="copy"}}return t}function r(){return{component:j}}function a(e,r,a){var o=N[e.id];if(o&&o.cancelDnd(),e.button<=1){o=new C(e.id),o.startX=e.x,o.startY=e.y,o.lastX=e.x,o.lastY=e.y,o.overNode=a,i(o,e);var l=t.bubble(a,"onDragStart",o);if(l){o.started=!0;var s=t.getDomNode(l.me);if(null==s)return o.destroy(),!1;var d=s.getBoundingClientRect;if(d){var c=d.call(s);o.deltaX=c.left-e.x,o.deltaY=c.top-e.y}o.distanceToStart<=0&&(o.beforeDrag=!1,n(a,o))}else o.destroy()}return!1}function n(e,r){r.overNode=e,r.targetCtx=t.bubble(e,"onDragOver",r),null==r.targetCtx&&(r.operation=0),t.broadcast("onDrag",r)}function i(t,e){t.shift=e.shift,t.ctrl=e.ctrl,t.alt=e.alt,t.meta=e.meta,t.x=e.x,t.y=e.y}function o(t,e,r){var a=N[t.id];if(!a)return!1;if(a.totalX+=Math.abs(t.x-a.lastX),a.totalY+=Math.abs(t.y-a.lastY),a.beforeDrag){if(a.totalX+a.totalY<=a.distanceToStart)return a.lastX=t.x,a.lastY=t.y,!1;a.beforeDrag=!1}return i(a,t),n(r,a),a.lastX=t.x,a.lastY=t.y,!0}function l(e,r,a){var o=N[e.id];if(!o)return!1;if(!o.beforeDrag){i(o,e),n(a,o);var l=o.targetCtx;return l&&t.bubble(l.me,"onDrop",o)?o.destroy():o.cancelDnd(),!0}return o.destroy(),!1}function s(t){var e=N[t.id];return e?(e.beforeDrag?e.destroy():e.cancelDnd(),!1):!1}function d(e,r){e.shift=r.shiftKey,e.ctrl=r.ctrlKey,e.alt=r.altKey,e.meta=r.metaKey,e.x=r.clientX,e.y=r.clientY,e.totalX+=Math.abs(e.x-e.lastX),e.totalY+=Math.abs(e.y-e.lastY);var a=t.nodeOnPoint(e.x,e.y);n(a,e),e.lastX=e.x,e.lastY=e.y}function c(e,r,a){var n=Y;null!=n&&n.destroy();var i=Object.keys(N);if(i.length>0)n=N[i[0]],n.system=!0,Y=n;else{var o=e.clientX,l=e.clientY;n=new C(-1),n.system=!0,Y=n,n.x=o,n.y=l,n.lastX=o,n.lastY=l,n.startX=o,n.startY=l;var s=t.bubble(a,"onDragStart",n);if(!s)return n.destroy(),!1;n.started=!0;var c=t.getDomNode(s.me);if(null==c)return n.destroy(),!1;var u=c.getBoundingClientRect;if(u){var f=u.call(c);n.deltaX=f.left-o,n.deltaY=f.top-l}}n.beforeDrag=!1;var h=P[n.enabledOperations],y=e.dataTransfer;if(y.effectAllowed=h,y.setDragImage){var g=document.createElement("div");g.style.pointerEvents="none",y.setDragImage(g,0,0)}else{var v=e.target.style,b=v.opacity,p=v.width,D=v.height,m=v.padding;v.opacity="0",v.width="0",v.height="0",v.padding="0",window.setTimeout(function(){v.opacity=b,v.width=p,v.height=D,v.padding=m},0)}for(var x=n.data,X=Object.keys(x),w=0;w<X.length;w++)try{var O=X[w],k=x[O];"string"!=typeof k&&(k=JSON.stringify(k)),e.dataTransfer.setData(O,k)}catch(T){}return d(n,e),!1}function u(t,e){t.dataTransfer.dropEffect=["none","link","copy","move"][e]}function f(t){var e=Y;if(null==e){e=new C(-1),e.system=!0,Y=e,e.x=t.clientX,e.y=t.clientY,e.startX=e.x,e.startY=e.y,e.local=!1;var r=t.dataTransfer,a=0;try{var n=r.effectAllowed}catch(i){}for(;7>a&&P[a]!==n;a++);e.enabledOperations=a;var o=r.types;if(o)for(var l=0;l<o.length;l++){var s=o[l];"text/plain"===s?s="Text":"text/uri-list"===s&&(s="Url"),e.data[s]=null}else void 0!==r.getData("Text")&&(e.data.Text=null)}return d(e,t),u(t,e.operation),0!=e.operation?(O(t),!0):!1}function h(e){var r=e.clientX,a=e.clientY,n=t.getMedia();return null!=Y&&(0===r&&0===a||0>r||0>a||r>=n.width||a>=n.height)&&(Y.x=0,Y.y=0,Y.operation=0,t.broadcast("onDrag",Y)),!1}function y(){return null!=Y&&Y.destroy(),!1}function g(e){var r=Y;if(null==r)return!1;if(r.x=e.clientX,r.y=e.clientY,!r.local)for(var a=Object.keys(r.data),n=e.dataTransfer,i=0;i<a.length;i++){var o,l=a[i];o="Files"===l?[].slice.call(n.files,0):n.getData(l),r.data[l]=o}d(r,e);var s=r.targetCtx;return s&&t.bubble(s.me,"onDrop",r)?(u(e,r.operation),r.destroy(),O(e)):r.cancelDnd(),!0}function v(t){return O(t),!0}function b(t){return 0===X.length?!1:(O(t),!0)}function p(){for(var t=0;t<X.length;t++){var e=X[t];if(!e.beforeDrag)return e}return null}var D,m,x=0,X=[],Y=null,w=null,O=t.preventDefault,k={userSelect:""};t.shimStyle(k);var T=Object.keys(k),S=T[T.length-1],C=function(e){if(this.id=++x,this.pointerid=e,this.enabledOperations=7,this.operation=0,this.started=!1,this.beforeDrag=!0,this.local=!0,this.system=!1,this.ended=!1,this.cursor=null,this.overNode=null,this.targetCtx=null,this.dragView=null,this.startX=0,this.startY=0,this.distanceToStart=10,this.x=0,this.y=0,this.deltaX=0,this.deltaY=0,this.totalX=0,this.totalY=0,this.lastX=0,this.lastY=0,this.shift=!1,this.ctrl=!1,this.alt=!1,this.meta=!1,this.data=Object.create(null),e>=0&&(N[e]=this),X.push(this),null==w){var a=document.body.style;D=a.cursor,m=a[S],a[S]="none",w=t.addRoot(r)}},M={render:function(t,e){var r=t.data;e.tag="div",e.style={position:"absolute",left:r.x,top:r.y},e.children=r.dragView(r)}},j={render:function(t,r){for(var a=[],n=0;n<X.length;n++){var i=X[n];i.beforeDrag||null==i.dragView||0==i.x&&0==i.y||a.push({key:""+i.id,data:i,component:M})}r.tag="div",r.style={position:"fixed",pointerEvents:"none",userSelect:"none",left:0,top:0,right:0,bottom:0};var o=document.body.style,l=e();l&&o.cursor!==l&&(o.cursor=l),r.children=a},onDrag:function(e){return t.invalidate(e),!1}},E=C.prototype;E.setOperation=function(t){this.operation=t},E.setDragNodeView=function(t){this.dragView=t},E.addData=function(t,e){return this.data[t]=e,!0},E.listData=function(){return Object.keys(this.data)},E.hasData=function(t){return void 0!==this.data[t]},E.getData=function(t){return this.data[t]},E.setEnabledOps=function(t){this.enabledOperations=t},E.cancelDnd=function(){n(null,this),this.destroy()},E.destroy=function(){this.ended=!0,this.started&&t.broadcast("onDragEnd",this),delete N[this.pointerid];for(var e=0;e<X.length;e++)if(X[e]===this){X.splice(e,1);break}if(Y===this&&(Y=null),0===X.length){t.removeRoot(w),w=null;var r=document.body.style;r.cursor=D,r[S]=m}};var N=Object.create(null),P=["none","link","copy","copyLink","move","linkMove","copyMove","all"],V=t.addEvent;V("!PointerDown",4,a),V("!PointerMove",4,o),V("!PointerUp",4,l),V("!PointerCancel",4,s),V("selectstart",4,b),V("dragstart",5,c),V("dragover",5,f),V("dragend",5,y),V("drag",5,h),V("drop",5,g),V("dragenter",5,v),V("dragleave",5,v),t.getDnds=function(){return X},t.anyActiveDnd=p}(b);