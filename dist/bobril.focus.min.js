!function(n){function t(){var t=document.hasFocus()?document.activeElement:null;if(t!==l){l=t;for(var e=n.vdomPath(l),o=0;o<s.length&&o<e.length&&s[o]===e[o];)o++;var r,u,i=s.length-1;for(i>=o&&(r=s[i],r&&(u=r.component,u&&u.onBlur&&u.onBlur(r.ctx)),i--);i>=o;)r=s[i],r&&(u=r.component,u&&u.onFocusOut&&u.onFocusOut(r.ctx)),i--;for(i=o;i+1<e.length;)r=e[i],r&&(u=r.component,u&&u.onFocusIn&&u.onFocusIn(r.ctx)),i++;i<e.length&&(r=e[i],r&&(u=r.component,u&&u.onFocus&&u.onFocus(r.ctx)),i++),s=e,a=0==s.length?null:s[s.length-1]}}function e(){setTimeout(t,10),t()}function o(){return a}function r(n,e){e.focus(),t()}function u(n){return c(n,h,r)}function i(n,t,e){return void 0===e&&(e=t),c(n,h,function(n,o){o.setSelectionRange(Math.min(t,e),Math.max(t,e),t>e?"backward":"forward");var r=n.component;r&&r.onSelectionChange&&r.onSelectionChange(n.ctx,{startPosition:t,endPosition:e})})}function c(t,e,o){if(null==t)return!1;if("string"==typeof t)return!1;var r=t.style;if(null!=r){if("hidden"===r.visibility)return!1;if("none"===r.display)return!1}var u=t.attrs;if(null!=u){var i=u.tabindex||u.tabIndex;if(void 0!==i||e.test(t.tag)){var l=t.element;return o(t,l),!0}}var a=t.children;if(n.isArray(a)){for(var s=0;s<a.length;s++)if(c(a[s],e,o))return!0;return!1}}for(var l=null,a=null,s=[],f=["focus","blur","keydown","keyup","keypress","mousedown","mouseup","mousemove","touchstart","touchend"],d=0;d<f.length;d++)n.addEvent(f[d],50,n.ieVersion()?e:t);var h=/^input$|^textarea$/g;n.focused=o,n.focus=u,n.select=i}(b);