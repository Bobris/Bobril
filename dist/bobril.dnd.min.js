!function(t){function e(){var t="no-drop";if(0!==D.length)switch(D[0].operation){case 3:t="move";break;case 1:t="alias";break;case 2:t="copy"}return t}function n(){return{component:O}}function a(t,e,n){var a=E[t.id];return a&&null==a.totalX&&a.cancelDnd(),1===t.button&&(E[t.id]={lastX:t.x,lastY:t.y,totalX:0,totalY:0,startX:t.x,startY:t.y,sourceNode:n}),!1}function r(e,n){n.overNode=e,n.targetCtx=t.bubble(e,"onDragOver",n),null==n.targetCtx&&(n.operation=0),t.broadcast("onDrag",n)}function o(){if(null!=X){var e=t.getRoots()[X].c;0!==e.length&&(e[0].style.pointerEvents="none")}}function i(n,a){n.shift=a.shift,n.ctrl=a.ctrl,n.alt=a.alt,n.meta=a.meta,n.x=a.x,n.y=a.y,o();var r,i=document.body.style;null==x&&(r=i.cursor,i.cursor=e());var l=t.nodeOnPoint(n.x,n.y);return null==x&&(i.cursor=r),l}function l(e,n,a){var o=E[e.id];if(o&&null==o.totalX)return a=i(o,e),r(a,o),!0;if(o&&null!=o.totalX&&(o.totalX+=Math.abs(e.x-o.lastX),o.totalY+=Math.abs(e.y-o.lastY),o.lastX=e.x,o.lastY=e.y,o.totalX+o.totalY>10)){a=o.sourceNode;var l=o.startX,s=o.startY;o=new Y(e.id),o.startX=l,o.startY=s,a=i(o,e);var d=t.bubble(a,"onDragStart",o);if(d){var c=t.getDomNode(d.me);if(null==c)return o.destroy(),!1;var u=c.getBoundingClientRect;if(u){var f=u.call(c);o.deltaX=f.left-l,o.deltaY=f.top-s}return r(a,o),!0}o.destroy()}return!1}function s(e,n,a){var o=E[e.id];if(o&&null==o.totalX){a=i(o,e),r(a,o);var l=o.targetCtx;return l&&t.bubble(l.me,"onDrop",o)?(o.ended=!0,t.broadcast("onDragEnd",o),o.destroy()):o.cancelDnd(),!0}return o&&delete E[e.id],!1}function d(t){var e=E[t.id];return e&&null==e.totalX?e.cancelDnd():delete E[t.id],!1}function c(e,n){e.shift=n.shiftKey,e.ctrl=n.ctrlKey,e.alt=n.altKey,e.meta=n.metaKey,e.x=n.clientX,e.y=n.clientY,o();var a=t.nodeOnPoint(e.x,e.y);r(a,e)}function u(e,n,a){var r=x;null!=r&&r.destroy();for(var o=Object.keys(E),i=e.clientX,l=e.clientY,s=-1,d=0;d<o.length;d++)if(r=E[o[d]],null!=r.totalX){s=+o[d],i=r.startX,l=r.startY,delete E[s];break}r=new Y(s),r.system=!0,x=r,r.x=e.clientX,r.y=e.clientY,r.startX=i,r.startY=l;var u=t.bubble(a,"onDragStart",r);if(u){var f=t.getDomNode(u.me);if(null==f)return r.destroy(),!1;var h=f.getBoundingClientRect;if(h){var v=h.call(f);r.deltaX=v.left-i,r.deltaY=v.top-l}var g=T[r.enabledOperations],y=e.dataTransfer;if(y.effectAllowed=g,y.setDragImage){var p=document.createElement("div");p.style.pointerEvents="none",y.setDragImage(p,0,0)}else{var b=f.style,D=b.opacity,X=b.width,m=b.height,w=b.padding;b.opacity="0",b.width="0",b.height="0",b.padding="0",window.setTimeout(function(){b.opacity=D,b.width=X,b.height=m,b.padding=w},0)}for(var O=r.data,k=Object.keys(O),d=0;d<k.length;d++)try{var C=k[d],N=O[C];"string"!=typeof N&&(N=JSON.stringify(N)),e.dataTransfer.setData(C,N)}catch(j){}c(r,e)}else r.destroy();return!1}function f(t,e){t.dataTransfer.dropEffect=["none","link","copy","move"][e]}function h(t){var e=x;if(null==e){e=new Y(-1),e.system=!0,x=e,e.x=t.clientX,e.y=t.clientY,e.startX=e.x,e.startY=e.y,e.local=!1;var n=t.dataTransfer,a=0;try{var r=n.effectAllowed}catch(o){}for(;7>a&&T[a]!==r;a++);e.enabledOperations=a;var i=n.types;if(i)for(var l=0;l<i.length;l++){var s=i[l];"text/plain"===s?s="Text":"text/uri-list"===s&&(s="Url"),e.data[s]=null}else void 0!==n.getData("Text")&&(e.data.Text=null)}return c(e,t),f(t,e.operation),0!=e.operation?(m(t),!0):!1}function v(e){var n=e.clientX,a=e.clientY,r=t.getMedia();return null!=x&&(0===n&&0===a||0>n||0>a||n>=r.width||a>=r.height)&&(x.x=0,x.y=0,x.operation=0,t.broadcast("onDrag",x)),!1}function g(){return null!=x&&(x.ended=!0,t.broadcast("onDragEnd",x),x.destroy()),!1}function y(e){var n=x;if(null==n)return!1;if(n.x=e.clientX,n.y=e.clientY,!n.local)for(var a=Object.keys(n.data),r=e.dataTransfer,o=0;o<a.length;o++){var i,l=a[o];i="Files"===l?[].slice.call(r.files,0):r.getData(l),n.data[l]=i}c(n,e);var s=n.targetCtx;return s&&t.bubble(s.me,"onDrop",n)?(f(e,n.operation),n.ended=!0,t.broadcast("onDragEnd",n),n.destroy(),m(e)):n.cancelDnd(),!0}function p(t){return m(t),!0}var b=0,D=[],x=null,X=null,m=t.preventDefault,Y=function(e){this.id=++b,this.pointerid=e,this.enabledOperations=7,this.operation=0,this.local=!0,this.system=!1,this.ended=!1,this.overNode=null,this.targetCtx=null,this.dragView=null,this.startX=0,this.startY=0,this.x=0,this.y=0,this.deltaX=0,this.deltaY=0,this.shift=!1,this.ctrl=!1,this.alt=!1,this.meta=!1,this.data=Object.create(null),e>=0&&(E[e]=this),D.push(this),null==X&&(X=t.addRoot(n))},w={render:function(t,e){var n=t.data;e.tag="div",e.style={position:"absolute",userSelect:"none",pointerEvents:"none",left:n.x,top:n.y},e.children=n.dragView(n)}},O={render:function(t,n){for(var a=[],r=0;r<D.length;r++){var o=D[r];null==o.dragView||0==o.x&&0==o.y||a.push({key:""+o.id,data:o,component:w})}n.tag="div",n.style={position:"fixed",userSelect:"none",left:0,top:0,right:0,bottom:0},null!=x?n.style.pointerEvents="none":(n.style.pointerEvents="all",n.style.cursor=e()),n.children=a},onDrag:function(e){return t.invalidate(e),!1}},k=Y.prototype;k.setOperation=function(t){this.operation=t},k.setDragNodeView=function(t){this.dragView=t},k.addData=function(t,e){return this.data[t]=e,!0},k.listData=function(){return Object.keys(this.data)},k.hasData=function(t){return void 0!==this.data[t]},k.getData=function(t){return this.data[t]},k.setEnabledOps=function(t){this.enabledOperations=t},k.cancelDnd=function(){r(null,this),this.ended=!0,t.broadcast("onDragEnd",this),this.destroy()},k.destroy=function(){delete E[this.pointerid];for(var e=0;e<D.length;e++)if(D[e]===this){D.splice(e,1);break}x===this&&(x=null),0===D.length&&(t.removeRoot(X),X=null)};var E=Object.create(null),T=["none","link","copy","copyLink","move","linkMove","copyMove","all"],C=t.addEvent;C("!PointerDown",4,a),C("!PointerMove",4,l),C("!PointerUp",4,s),C("!PointerCancel",4,d),C("dragstart",5,u),C("dragover",5,h),C("dragend",5,g),C("drag",5,v),C("drop",5,y),C("dragenter",5,p),C("dragleave",5,p),t.getDnds=function(){return D}}(b);