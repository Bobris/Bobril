!function(n){function o(){var o=document.hasFocus()?document.activeElement:null;if(o!==c){c=o;for(var u=n.vdomPath(c),t=0;t<r.length&&t<u.length&&r[t]===u[t];)t++;var e,s,f=r.length-1;for(f>=t&&(e=r[f],e&&(s=e.component,s&&s.onBlur&&s.onBlur(e.ctx)),f--);f>=t;)e=r[f],e&&(s=e.component,s&&s.onFocusOut&&s.onFocusOut(e.ctx)),f--;for(f=t;f+1<u.length;)e=u[f],e&&(s=e.component,s&&s.onFocusIn&&s.onFocusIn(e.ctx)),f++;f<u.length&&(e=u[f],e&&(s=e.component,s&&s.onFocus&&s.onFocus(e.ctx)),f++),r=u,l=0==r.length?null:r[r.length-1]}return!1}function u(){setTimeout(o,10),o()}function t(){return l}function e(u){if(null!=u){var t=u.element;n.isArray(t)&&(t=t[0]),t.focus(),o()}}for(var c=null,l=null,r=[],s=["fucus","blur","keydown","keyup","keypress","mousedown","mouseup","mousemove","touchstart","touchend"],f=0;f<s.length;f++)n.addEvent(s[f],50,u);n.focused=t,n.focus=e}(b);