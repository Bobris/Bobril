!function(t){function e(t,e,n){var a=u[t.id];return a&&null==a.totalX&&a.cancelDnd(),u[t.id]={lastX:t.x,lastY:t.y,totalX:0,totalY:0,sourceNode:n},!1}function n(e,n){n.targetCtx=null,null!=e&&t.bubble(e,"onDragOver",n)&&null!=n.targetCtx||(n.operation=0),t.bubble(n.sourceCtx.me,"onDrag",n);for(var a=n.targetPath,o=[],r=n.targetCtx,l=r?r.me:null;l;)r=l.ctx,r&&o.push(r),l=l.parent;for(var i=0;i<a.length&&i<o.length&&a[i]===o[i];)i++;for(var u,s,d=a.length;d>i;)d--,u=a[d],s=u.me.component,s.onDragLeave&&s.onDragLeave(u,n);for(;d<o.length;)u=o[d],s=u.me.component,s.onDragEnter&&s.onDragEnter(u,n),d++;n.targetPath=o}function a(e,a,o){console.log(o,e.x,e.y);var r=u[e.id];if(r&&null==r.totalX)return r.x=e.x,r.y=e.y,n(o,r),!0;if(r&&null!=r.totalX&&(r.totalX+=Math.abs(e.x-r.lastX),r.totalY+=Math.abs(e.y-r.lastY),r.lastX=e.x,r.lastY=e.y,r.totalX+r.totalY>20)){if(o=r.sourceNode,r=new i,r.x=e.x,r.y=e.y,r.pointerId=e.id,t.bubble(o,"onDragStart",r)&&null!=r.sourceCtx)return u[e.id]=r,n(o,r),!0;delete u[e.id]}return!1}function o(e,a,o){var r=u[e.id];if(r&&null==r.totalX){r.x=e.x,r.y=e.y,n(o,r);var l=r.targetCtx;return l&&t.bubble(l.me,"onDrop",r)?(t.bubble(r.sourceCtx.me,"onDragEnd",this),n(null,r),delete u[this.pointerid]):r.cancelDnd(),!0}return r&&delete u[e.id],!1}function r(t){var e=u[t.id];return e&&null==e.totalX?e.cancelDnd():delete u[t.id],!1}var l=0,i=function(){this.id=++l,this.pointerid=-1,this.linkEnabled=!0,this.copyEnabled=!0,this.moveEnabled=!0,this.operation=0,this.sourceCtx=null,this.targetCtx=null,this.targetPath=[],this.x=0,this.y=0,this.shift=!1,this.ctrl=!1,this.alt=!1,this.meta=!1,this.data=Object.create(null)};i.prototype.setSource=function(t){this.sourceCtx=t},i.prototype.setTargetAndOperation=function(t,e){this.targetCtx=t,this.operation=e},i.prototype.addData=function(t,e){return this.data[t]=e,!0},i.prototype.hasData=function(t){return void 0!==this.data[t]},i.prototype.getData=function(t){return this.data[t]},i.prototype.setOpEnabled=function(t,e,n){this.linkEnabled=t,this.copyEnabled=e,this.moveEnabled=n},i.prototype.cancelDnd=function(){n(null,this),t.bubble(this.sourceCtx.me,"onDragEnd",this),delete u[this.pointerid]};var u=Object.create(null),s=t.addEvent;s("!PointerDown",4,e),s("!PointerMove",4,a),s("!PointerUp",4,o),s("!PointerCancel",4,r)}(b);