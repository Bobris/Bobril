!function(n){function t(){var t=document.hasFocus()?document.activeElement:null;if(t!==r){r=t;for(var e=n.vdomPath(r),o=0;o<c.length&&o<e.length&&c[o]===e[o];)o++;var u,i,s=c.length-1;for(s>=o&&(u=c[s],u&&(i=u.component,i&&i.onBlur&&i.onBlur(u.ctx)),s--);s>=o;)u=c[s],u&&(i=u.component,i&&i.onFocusOut&&i.onFocusOut(u.ctx)),s--;for(s=o;s+1<e.length;)u=e[s],u&&(i=u.component,i&&i.onFocusIn&&i.onFocusIn(u.ctx)),s++;s<e.length&&(u=e[s],u&&(i=u.component,i&&i.onFocus&&i.onFocus(u.ctx)),s++),c=e,l=0==c.length?null:c[c.length-1]}}function e(){setTimeout(t,10),t()}function o(){return l}function u(e){if(null==e)return!1;if("string"==typeof e)return!1;var o=e.style;if(null!=o){if("hidden"===o.visibility)return!1;if("none"===o.display)return!1}var r=e.attrs;if(null!=r){var l=r.tabindex||r.tabIndex;if(void 0!==l||f.test(e.tag)){var c=e.element;return c.focus(),t(),!0}}var i=e.children;if(n.isArray(i)){for(var s=0;s<i.length;s++)if(u(i[s]))return!0;return!1}return!1}for(var r=null,l=null,c=[],i=["focus","blur","keydown","keyup","keypress","mousedown","mouseup","mousemove","touchstart","touchend"],s=0;s<i.length;s++)n.addEvent(i[s],50,n.ieVersion()?e:t);var f=/^input$|^select$|^textarea$|^button$/;n.focused=o,n.focus=u}(b);