!function(n){function t(){var t=document.hasFocus()?document.activeElement:null;if(t!==r){r=t;for(var e=n.vdomPath(r),o=0;o<i.length&&o<e.length&&i[o]===e[o];)o++;var u,c,a=i.length-1;for(a>=o&&(u=i[a],u&&(c=u.component,c&&c.onBlur&&c.onBlur(u.ctx)),a--);a>=o;)u=i[a],u&&(c=u.component,c&&c.onFocusOut&&c.onFocusOut(u.ctx)),a--;for(a=o;a+1<e.length;)u=e[a],u&&(c=u.component,c&&c.onFocusIn&&c.onFocusIn(u.ctx)),a++;a<e.length&&(u=e[a],u&&(c=u.component,c&&c.onFocus&&c.onFocus(u.ctx)),a++),i=e,l=0==i.length?null:i[i.length-1]}}function e(){setTimeout(t,10)}function o(){return l}function u(e){if(null==e)return!1;if("string"==typeof e)return!1;var o=e.style;if(null!=o){if("hidden"===o.visibility)return!1;if("none"===o.display)return!1}var r=e.attrs;if(null!=r){var l=null!=r.tabindex?r.tabindex:r.tabIndex;if(void 0!==l||c.test(e.tag)){var i=e.element;return i.focus(),t(),!0}}var a=e.children;if(n.isArray(a))for(var f=0;f<a.length;f++)if(u(a[f]))return!0;return!1}var r=null,l=null,i=[];n.addEvent("^focus",50,t),n.addEvent("^blur",50,e);var c=/^input$|^select$|^textarea$|^button$/;n.focused=o,n.focus=u}(b);