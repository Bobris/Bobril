!function(t){function e(t,e,n){var a=s[t.id];return a&&null==a.totalX&&a.cancelDnd(),s[t.id]={lastX:t.x,lastY:t.y,totalX:0,totalY:0,sourceNode:n},!1}function n(e,n){n.targetCtx=null,null!=e&&t.bubble(e,"onDragOver",n)&&null!=n.targetCtx||(n.operation=0),t.bubble(n.sourceCtx.me,"onDrag",n);for(var a=n.targetPath,r=[],o=n.targetCtx,l=o?o.me:null;l;)o=l.ctx,o&&r.push(o),l=l.parent;for(var i=0;i<a.length&&i<r.length&&a[i]===r[i];)i++;for(var s,u,h=a.length;h>i;)h--,s=a[h],u=s.me.component,u.onDragLeave&&u.onDragLeave(s,n);for(;h<r.length;)s=r[h],u=s.me.component,u.onDragEnter&&u.onDragEnter(s,n),h++;n.targetPath=r}function a(e,a,r){var o=s[e.id];if(o&&null==o.totalX)return o.x=e.x,o.y=e.y,n(r,o),!0;if(o&&null!=o.totalX)if(o.totalX+=Math.abs(e.x-o.lastX),o.totalY+=Math.abs(e.y-o.lastY),o.lastX=e.x,o.lastY=e.y,o.totalX+o.totalY>20){if(r=o.sourceNode,o=new i,o.x=e.x,o.y=e.y,o.pointerId=e.id,o.sourceCtx=r,t.bubble(r,"onDragStart",o)&&null!=o.sourceCtx)return s[e.id]=o,n(r,o),!0}else delete s[e.id];return!1}function r(e,a,r){var o=s[e.id];if(o&&null==o.totalX){o.x=e.x,o.y=e.y,n(r,o);var l=o.targetCtx;return a&&t.bubble(l.me,"onDrop",o)?(t.bubble(this.sourceCtx.me,"onDragEnd",this),n(null,this),delete s[this.pointerid]):o.cancelDnd(),!0}return!1}function o(t){var e=s[t.id];return e&&null==e.totalX&&e.cancelDnd(),!1}var l=0,i=function(){this.id=++l,this.pointerid=-1,this.linkEnabled=!0,this.copyEnabled=!0,this.moveEnabled=!0,this.operation=0,this.sourceCtx=null,this.targetCtx=null,this.targetPath=[],this.x=0,this.y=0,this.shift=!1,this.ctrl=!1,this.alt=!1,this.meta=!1,this.data=Object.create(null)};i.prototype.setTargetAndOperation=function(t,e){this.targetCtx=t,this.operation=e},i.prototype.addData=function(t,e){return this.data[t]=e,!0},i.prototype.hasData=function(t){return void 0!==this.data[t]},i.prototype.getData=function(t){return this.data[t]},i.prototype.setOpEnabled=function(t,e,n){this.linkEnabled=t,this.copyEnabled=e,this.moveEnabled=n},i.prototype.cancelDnd=function(){n(null,this),t.bubble(this.sourceCtx.me,"onDragEnd",this),delete s[this.pointerid]};var s=Object.create(null),u=t.addEvent;u("!PointerDown",60,e),u("!PointerMove",60,a),u("!PointerUp",60,r),u("!PointerCancel",60,o)}(b);