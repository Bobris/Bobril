!function(n){function t(){var t=document.hasFocus()?document.activeElement:null;if(t!==r){r=t;for(var e=n.vdomPath(r),o=0;o<i.length&&o<e.length&&i[o]===e[o];)o++;var u,c,s=i.length-1;for(s>=o&&(u=i[s],u&&(c=u.component,c&&c.onBlur&&c.onBlur(u.ctx)),s--);s>=o;)u=i[s],u&&(c=u.component,c&&c.onFocusOut&&c.onFocusOut(u.ctx)),s--;for(s=o;s+1<e.length;)u=e[s],u&&(c=u.component,c&&c.onFocusIn&&c.onFocusIn(u.ctx)),s++;s<e.length&&(u=e[s],u&&(c=u.component,c&&c.onFocus&&c.onFocus(u.ctx)),s++),i=e,l=0==i.length?null:i[i.length-1]}}function e(){setTimeout(t,10),t()}function o(){return l}function u(e){if(null==e)return!1;if("string"==typeof e)return!1;var o=e.style;if(null!=o){if("hidden"===o.visibility)return!1;if("none"===o.display)return!1}var r=e.attrs;if(null!=r){var l=r.tabindex||r.tabIndex;if(void 0!==l||f.test(e.tag)){if(-1===+l)return!1;var i=e.element;return i.focus(),t(),!0}}var c=e.children;if(n.isArray(c)){for(var s=0;s<c.length;s++)if(u(c[s]))return!0;return!1}return u(c)}for(var r=null,l=null,i=[],c=["focus","blur","keydown","keyup","keypress","mousedown","mouseup","mousemove","touchstart","touchend"],s=0;s<c.length;s++)n.addEvent(c[s],50,n.ieVersion()?e:t);var f=/^input$|^select$|^textarea$|^button$/;n.focused=o,n.focus=u}(b);