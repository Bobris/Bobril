!function(n){function o(){var o=document.hasFocus()?document.activeElement:null;if(o!==c){c=o;for(var e=n.vdomPath(c),t=0;t<s.length&&t<e.length&&s[t]===e[t];)t++;var u,r,f=s.length-1;for(f>=t&&(u=s[f],u&&(r=u.component,r&&r.onBlur&&r.onBlur(u.ctx)),f--);f>=t;)u=s[f],u&&(r=u.component,r&&r.onFocusOut&&r.onFocusOut(u.ctx)),f--;for(f=t;f+1<e.length;)u=e[f],u&&(r=u.component,r&&r.onFocusIn&&r.onFocusIn(u.ctx)),f++;f<e.length&&(u=e[f],u&&(r=u.component,r&&r.onFocus&&r.onFocus(u.ctx)),f++),s=e,l=0==s.length?null:s[s.length-1]}}function e(){setTimeout(o,10),o()}function t(){return l}function u(e){if(null!=e){var t=e.element;n.isArray(t)&&(t=t[0]),t.focus(),o()}}for(var c=null,l=null,s=[],r=["fucus","blur","keydown","keyup","keypress","mousedown","mouseup","mousemove","touchstart","touchend"],f=0;f<r.length;f++)n.addEvent(r[f],50,n.ieVersion()?e:o);8===n.ieVersion()&&setInterval(o,100),n.focused=t,n.focus=u}(b);